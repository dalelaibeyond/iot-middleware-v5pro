{"error":"Database is not connected. Unable to start StorageService.","level":"error","message":"StorageService: Failed to start","service":"iot-middleware-v5","stack":"Error: Database is not connected. Unable to start StorageService.\n    at StorageService.start (d:\\_prog\\_dig\\iot-middleware-v5\\src\\modules\\storage\\StorageService.js:25:15)\n    at testStorageService (d:\\_prog\\_dig\\iot-middleware-v5\\test\\storage-service-test.js:81:30)\n    at Object.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\test\\storage-service-test.js:99:1)\n    at Module._compile (node:internal/modules/cjs/loader:1706:14)\n    at Object..js (node:internal/modules/cjs/loader:1839:10)\n    at Module.load (node:internal/modules/cjs/loader:1441:32)\n    at Function._load (node:internal/modules/cjs/loader:1263:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:328:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:171:5)","timestamp":"2025-12-25 09:03:07"}
{"database":"iot_middleware_test","error":"Database connection test failed: Access denied for user 'root'@'localhost' (using password: NO)","host":"localhost","level":"error","message":"Database: Failed to connect","service":"iot-middleware-v5","stack":"Error: Database connection test failed: Access denied for user 'root'@'localhost' (using password: NO)\n    at Database._testConnection (d:\\_prog\\_dig\\iot-middleware-v5\\src\\core\\Database.js:86:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Database.connect (d:\\_prog\\_dig\\iot-middleware-v5\\src\\core\\Database.js:55:7)\n    at async E2EFlowTest.initialize (d:\\_prog\\_dig\\iot-middleware-v5\\test\\e2e-flow.js:34:7)\n    at async E2EFlowTest.runTest (d:\\_prog\\_dig\\iot-middleware-v5\\test\\e2e-flow.js:78:7)\n    at async main (d:\\_prog\\_dig\\iot-middleware-v5\\test\\e2e-flow.js:179:5)","timestamp":"2025-12-25 17:27:21"}
{"level":"error","message":"E2EFlowTest: ❌ Pipeline Failed - Timeout waiting for completion","service":"iot-middleware-v5","timestamp":"2025-12-25 17:28:05"}
{"error":"insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:29:40.573Z'), ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:29:40.573Z') - Incorrect datetime value: '2025-12-25T09:29:40.573Z' for column 'timestamp' at row 1","level":"error","message":"StorageService: Error saving telemetry batch","recordCount":2,"service":"iot-middleware-v5","stack":"Error: insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:29:40.573Z'), ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:29:40.573Z') - Incorrect datetime value: '2025-12-25T09:29:40.573Z' for column 'timestamp' at row 1\n    at Packet.asError (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packets\\packet.js:740:17)\n    at Query.execute (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\commands\\command.js:29:26)\n    at Connection.handlePacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:508:34)\n    at PacketParser.onPacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:519:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)","timestamp":"2025-12-25 17:29:40"}
{"batchSize":3,"error":"insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:29:40.573Z'), ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:29:40.573Z') - Incorrect datetime value: '2025-12-25T09:29:40.573Z' for column 'timestamp' at row 1","level":"error","message":"StorageService: Error saving batch","service":"iot-middleware-v5","stack":"Error: insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:29:40.573Z'), ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:29:40.573Z') - Incorrect datetime value: '2025-12-25T09:29:40.573Z' for column 'timestamp' at row 1\n    at Packet.asError (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packets\\packet.js:740:17)\n    at Query.execute (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\commands\\command.js:29:26)\n    at Connection.handlePacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:508:34)\n    at PacketParser.onPacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:519:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)","timestamp":"2025-12-25 17:29:40"}
{"dataSize":3,"error":"insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:29:40.573Z'), ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:29:40.573Z') - Incorrect datetime value: '2025-12-25T09:29:40.573Z' for column 'timestamp' at row 1","level":"error","message":"StorageService: Error handling normalized data","service":"iot-middleware-v5","stack":"Error: insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:29:40.573Z'), ('2025-12-25 17:29:40.574', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:29:40.573Z') - Incorrect datetime value: '2025-12-25T09:29:40.573Z' for column 'timestamp' at row 1\n    at Packet.asError (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packets\\packet.js:740:17)\n    at Query.execute (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\commands\\command.js:29:26)\n    at Connection.handlePacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:508:34)\n    at PacketParser.onPacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:519:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)","timestamp":"2025-12-25 17:29:40"}
{"level":"error","message":"E2EFlowTest: ❌ Pipeline Failed - Timeout waiting for completion","service":"iot-middleware-v5","timestamp":"2025-12-25 17:29:45"}
{"error":"insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:48:35.549Z'), ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:48:35.549Z') - Incorrect datetime value: '2025-12-25T09:48:35.549Z' for column 'timestamp' at row 1","level":"error","message":"StorageService: Error saving telemetry batch","recordCount":2,"service":"iot-middleware-v5","stack":"Error: insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:48:35.549Z'), ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:48:35.549Z') - Incorrect datetime value: '2025-12-25T09:48:35.549Z' for column 'timestamp' at row 1\n    at Packet.asError (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packets\\packet.js:740:17)\n    at Query.execute (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\commands\\command.js:29:26)\n    at Connection.handlePacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:508:34)\n    at PacketParser.onPacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:519:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)","timestamp":"2025-12-25 17:48:35"}
{"batchSize":3,"error":"insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:48:35.549Z'), ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:48:35.549Z') - Incorrect datetime value: '2025-12-25T09:48:35.549Z' for column 'timestamp' at row 1","level":"error","message":"StorageService: Error saving batch","service":"iot-middleware-v5","stack":"Error: insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:48:35.549Z'), ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:48:35.549Z') - Incorrect datetime value: '2025-12-25T09:48:35.549Z' for column 'timestamp' at row 1\n    at Packet.asError (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packets\\packet.js:740:17)\n    at Query.execute (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\commands\\command.js:29:26)\n    at Connection.handlePacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:508:34)\n    at PacketParser.onPacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:519:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)","timestamp":"2025-12-25 17:48:35"}
{"dataSize":3,"error":"insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:48:35.549Z'), ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:48:35.549Z') - Incorrect datetime value: '2025-12-25T09:48:35.549Z' for column 'timestamp' at row 1","level":"error","message":"StorageService: Error handling normalized data","service":"iot-middleware-v5","stack":"Error: insert into `iot_telemetry` (`created_at`, `device_id`, `device_type`, `mod_addr`, `sensor_addr`, `telemetry_key`, `telemetry_value`, `timestamp`) values ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'voltage', 12.5, '2025-12-25T09:48:35.549Z'), ('2025-12-25 17:48:35.550', '2437871205', 'V5008', 0, 0, 'current', 0.8, '2025-12-25T09:48:35.549Z') - Incorrect datetime value: '2025-12-25T09:48:35.549Z' for column 'timestamp' at row 1\n    at Packet.asError (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packets\\packet.js:740:17)\n    at Query.execute (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\commands\\command.js:29:26)\n    at Connection.handlePacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:508:34)\n    at PacketParser.onPacket (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (d:\\_prog\\_dig\\iot-middleware-v5\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:519:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)","timestamp":"2025-12-25 17:48:35"}
{"level":"error","message":"E2EFlowTest: ❌ Pipeline Failed - Timeout waiting for completion","service":"iot-middleware-v5","timestamp":"2025-12-25 17:48:40"}
{"level":"error","message":"E2EFlowTest: ❌ Pipeline Failed - Timeout waiting for completion","service":"iot-middleware-v5","timestamp":"2025-12-25 18:04:04"}
{"level":"error","message":"E2EFlowTest: ❌ Pipeline Failed - Timeout waiting for completion","service":"iot-middleware-v5","timestamp":"2025-12-25 18:05:03"}
{"database":"iot_middleware","error":"Database connection test failed: Access denied for user 'root'@'localhost' (using password: NO)","host":"localhost","level":"error","message":"Database: Failed to connect","service":"iot-middleware-v5","stack":"Error: Database connection test failed: Access denied for user 'root'@'localhost' (using password: NO)\n    at Database._testConnection (d:\\_prog\\_dig\\iot-middleware-v5\\src\\core\\Database.js:86:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Database.connect (d:\\_prog\\_dig\\iot-middleware-v5\\src\\core\\Database.js:55:7)\n    at async IoTMiddlewareApp.initialize (d:\\_prog\\_dig\\iot-middleware-v5\\src\\app.js:69:7)\n    at async startApp (d:\\_prog\\_dig\\iot-middleware-v5\\src\\app.js:283:5)","timestamp":"2025-12-25 19:21:27"}
{"error":"","level":"error","message":"MqttService: MQTT error","service":"iot-middleware-v5","stack":"AggregateError [ECONNREFUSED]: \n    at internalConnectMultiple (node:net:1134:18)\n    at afterConnectMultiple (node:net:1715:7)","timestamp":"2025-12-25 19:21:59"}
